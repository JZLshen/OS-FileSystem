# 模拟UNIX风格多用户文件系统

*一个基于 Python 和 PyQt6 的高仿真度、图形化、多用户、多级目录文件系统模拟器，专为操作系统课程设计而生。*

本项目不仅实现了标准文件系统的核心功能，还提供了一个现代、直观的图形用户界面，使用户能够轻松地与模拟的文件系统进行交互。它深度模拟了UNIX文件系统的内部机制，包括i节点、数据块管理、持久化存储和用户会话等，是学习和理解操作系统文件系统原理的绝佳实践。

## ✨ 功能亮点

  - **现代化的图形界面 (GUI)**

      - ✅ 类似文件资源管理器的直观布局，包含目录树、文件列表和地址栏。
      - ✅ 右键上下文菜单和菜单栏，提供所有核心操作的便捷入口。
      - ✅ 可视化的文件和目录属性查看器。
      - ✅ 内置简易文本编辑器，支持文本文件的创建、查看和修改。

  - **完整的文件系统核心功能**

      - ✅ **多级目录结构**：支持任意深度的目录嵌套。
      - ✅ **文件操作**：创建 (`create`)、删除 (`rm`)、重命名 (`rename`)。
      - ✅ **目录操作**：创建 (`mkdir`)、删除 (`rmdir`)、重命名 (`rename`)。
      - ✅ **文件I/O**：完整的打开 (`open`)、读 (`read`)、写 (`write`)、关闭 (`close`) 工作流。
      - ✅ **可排序视图**：文件列表支持按名称、大小、类型和修改日期进行升/降序排序。

  - **高级系统与用户管理**

      - ✅ **多用户支持**：实现了用户登录 (`login`) 和注销 (`logout`) 功能。
      - ✅ **权限分离**：`root` 用户拥有特殊权限，如格式化磁盘和创建新用户。
      - ✅ **持久化存储**：所有对文件系统的更改都会被保存到本地的 `simulated_disk.img` 文件中，关闭程序后数据不丢失。
      - ✅ **系统级操作**：支持对整个模拟磁盘进行格式化 (`format`)。


## 🛠️ 技术栈

  * **核心语言**: Python 3
  * **图形界面**: PyQt6
  * **数据序列化**: Pickle (用于持久化)

## 🚀 快速开始

#### 1\. 先决条件

  - 确保您的系统中已安装 Python 3.6 或更高版本。
  - 推荐使用虚拟环境。

#### 2\. 安装依赖

本项目仅依赖 PyQt6。使用 pip 进行安装：

```bash
pip install PyQt6
```

#### 3\. 运行程序

克隆或下载本项目后，在项目根目录下运行 `main.py`：

```bash
python main.py
```

程序将启动并显示登录窗口。

## 📖 使用指南

1.  **登录**：
    * 程序启动后，使用默认账户登录。
    * 管理员账户：用户名 `root`，密码 `root`。
    * 普通账户：用户名 `guest`，密码 `guest`。

2.  **主界面**：
    * **左侧**：目录树视图，用于快速导航。
    * **右侧**：文件列表视图，显示当前目录下的文件和子目录。可以通过点击列标题进行排序。
    * **地址栏**：显示当前工作目录的绝对路径。
    * **菜单栏**：
        * 提供“上一级”、“新建文件夹”、“新建文件”、“重命名”、“属性”、“删除”等常用操作。
        * “系统管理”菜单（仅对`root`用户启用）提供“创建用户”和“格式化磁盘”功能。

3.  **交互**：
    * **双击**：在文件列表视图中双击目录可进入该目录；双击文本文件可使用内置编辑器打开。
    * **右键单击**：在文件列表视图中右键单击文件或目录，会弹出上下文菜单，提供常用操作。
    * **删除操作**：选中文件或目录后，可按 `Delete` 键或通过菜单/上下文菜单删除。


## 🧠 核心概念模拟

本项目旨在深入模拟文件系统的核心设计：

  * **磁盘与文件卷**：通过 `DiskManager` 类在内存中模拟一个完整的文件卷，包含超级块、位图、i节点区和数据区。
  * **i节点 (Inode)**：每个文件和目录都由一个唯一的 `Inode` 对象描述，其中存储了元数据（大小、权限、所有者、时间戳）和指向数据块的指针列表。
  * **目录结构**：目录是一种特殊的文件，其数据块中存储的是一个 `DirectoryEntry` 列表，每个条目将文件名映射到一个i节点号，从而构建起整个文件系统的层级关系。
  * **持久化**：通过 `PersistenceManager`，整个 `DiskManager` 对象在程序关闭时被序列化并写入磁盘文件，实现了对模拟文件系统的“断电保护”。
## 🔮 未来可改进方向

  * **高级文件系统特性**:
      * 实现间接寻址（单级、多级间接块）以支持大文件。
      * 增加硬链接和符号链接的支持。
      * 实现更完整的权限系统（用户组、`chmod`、`chown`）。
  * **GUI 体验**:
      * 增加文件/目录的拖拽移动和复制功能。
      * 为不同文件类型提供不同图标。
      * 地址栏支持手动输入路径进行导航。
  * **健壮性**:
      * 引入日志或事务机制，以保证文件系统操作的原子性，防止意外中断导致的状态不一致。


## 📄 许可证

本项目采用 [MIT License](https://opensource.org/licenses/MIT) 授权。